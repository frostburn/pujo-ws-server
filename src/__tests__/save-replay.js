import {DEFAULT_MARGIN_FRAMES} from 'pujo-puyo-core';
import {saveReplay} from '../storage.js';
import sql from '../db.js';

const LUMI_VS_FLEX2 = {
  gameSeed: 3864657304,
  screenSeed: 2580717322,
  colorSelections: [
    [3, 1, 0, 2],
    [3, 1, 0, 2],
  ],
  targetPoints: [70, 70],
  marginFrames: DEFAULT_MARGIN_FRAMES,
  mercyFrames: Infinity,
  metadata: {
    event:
      'First human vs. machine game to be captured in algebraic notation for Puyo',
    site: 'http://localhost:5173/',
    names: ['Lumi Pakkanen', 'FlexDroplet 2'],
    elos: [3000, 2675],
    round: 1,
    priorWins: [1, 0],
    msSince1970: new Date('2023-10-07').valueOf(),
    type: 'pausing',
  },
  result: {
    winner: 0,
    reason: 'lockout',
  },
  moves: [
    {player: 0, time: 0, x1: 0, y1: 15, x2: 1, y2: 15, orientation: 3},
    {player: 1, time: 0, x1: 5, y1: 15, x2: 4, y2: 15, orientation: 1},
    {player: 0, time: 18, x1: 5, y1: 14, x2: 5, y2: 15, orientation: 2},
    {player: 1, time: 18, x1: 0, y1: 14, x2: 0, y2: 15, orientation: 2},
    {player: 0, time: 36, x1: 0, y1: 14, x2: 1, y2: 14, orientation: 3},
    {player: 1, time: 36, x1: 3, y1: 15, x2: 2, y2: 15, orientation: 1},
    {player: 0, time: 54, x1: 4, y1: 15, x2: 4, y2: 14, orientation: 0},
    {player: 1, time: 54, x1: 1, y1: 15, x2: 1, y2: 14, orientation: 0},
    {player: 0, time: 72, x1: 0, y1: 12, x2: 0, y2: 13, orientation: 2},
    {player: 1, time: 72, x1: 2, y1: 14, x2: 2, y2: 13, orientation: 0},
    {player: 0, time: 90, x1: 0, y1: 10, x2: 0, y2: 11, orientation: 2},
    {player: 1, time: 90, x1: 1, y1: 13, x2: 0, y2: 13, orientation: 1},
    {player: 0, time: 108, x1: 2, y1: 14, x2: 2, y2: 15, orientation: 2},
    {player: 0, time: 126, x1: 2, y1: 13, x2: 1, y2: 13, orientation: 1},
    {player: 0, time: 144, x1: 3, y1: 14, x2: 3, y2: 15, orientation: 2},
    {player: 0, time: 162, x1: 4, y1: 13, x2: 3, y2: 13, orientation: 1},
    {player: 1, time: 169, x1: 3, y1: 15, x2: 2, y2: 15, orientation: 1},
    {player: 1, time: 187, x1: 3, y1: 14, x2: 4, y2: 14, orientation: 3},
    {player: 0, time: 209, x1: 1, y1: 11, x2: 1, y2: 10, orientation: 0},
    {player: 0, time: 227, x1: 1, y1: 8, x2: 0, y2: 8, orientation: 1},
    {player: 0, time: 246, x1: 2, y1: 12, x2: 2, y2: 11, orientation: 0},
    {player: 0, time: 264, x1: 3, y1: 11, x2: 4, y2: 11, orientation: 3},
    {player: 1, time: 266, x1: 2, y1: 14, x2: 2, y2: 15, orientation: 2},
    {player: 1, time: 284, x1: 3, y1: 14, x2: 3, y2: 15, orientation: 2},
    {player: 1, time: 302, x1: 4, y1: 15, x2: 4, y2: 14, orientation: 0},
    {player: 0, time: 310, x1: 2, y1: 7, x2: 1, y2: 7, orientation: 1},
    {player: 1, time: 320, x1: 2, y1: 13, x2: 2, y2: 12, orientation: 0},
    {player: 0, time: 330, x1: 2, y1: 8, x2: 3, y2: 8, orientation: 3},
    {player: 1, time: 338, x1: 1, y1: 15, x2: 1, y2: 14, orientation: 0},
    {player: 0, time: 350, x1: 0, y1: 6, x2: 1, y2: 6, orientation: 3},
    {player: 1, time: 356, x1: 2, y1: 10, x2: 2, y2: 11, orientation: 2},
    {player: 0, time: 368, x1: 3, y1: 9, x2: 3, y2: 8, orientation: 0},
    {player: 1, time: 374, x1: 1, y1: 9, x2: 2, y2: 9, orientation: 3},
    {player: 0, time: 386, x1: 4, y1: 9, x2: 4, y2: 8, orientation: 0},
    {player: 1, time: 396, x1: 1, y1: 12, x2: 1, y2: 11, orientation: 0},
    {player: 0, time: 404, x1: 3, y1: 7, x2: 3, y2: 6, orientation: 0},
    {player: 1, time: 414, x1: 0, y1: 10, x2: 1, y2: 10, orientation: 3},
    {player: 0, time: 422, x1: 5, y1: 11, x2: 5, y2: 10, orientation: 0},
    {player: 0, time: 440, x1: 5, y1: 9, x2: 5, y2: 8, orientation: 0},
    {player: 0, time: 458, x1: 5, y1: 6, x2: 5, y2: 7, orientation: 2},
    {player: 0, time: 476, x1: 2, y1: 5, x2: 3, y2: 5, orientation: 3},
    {player: 0, time: 496, x1: 3, y1: 4, x2: 3, y2: 3, orientation: 0},
    {player: 0, time: 514, x1: 3, y1: 2, x2: 3, y2: 1, orientation: 0},
    {player: 0, time: 532, x1: 4, y1: 6, x2: 4, y2: 7, orientation: 2},
    {player: 1, time: 579, x1: 2, y1: 15, x2: 2, y2: 14, orientation: 0},
    {player: 1, time: 597, x1: 4, y1: 15, x2: 3, y2: 15, orientation: 1},
    {player: 1, time: 615, x1: 4, y1: 14, x2: 3, y2: 14, orientation: 1},
    {player: 1, time: 633, x1: 3, y1: 13, x2: 3, y2: 12, orientation: 0},
    {player: 1, time: 651, x1: 3, y1: 11, x2: 2, y2: 11, orientation: 1},
    {player: 1, time: 671, x1: 5, y1: 15, x2: 5, y2: 14, orientation: 0},
    {player: 1, time: 791, x1: 4, y1: 14, x2: 4, y2: 15, orientation: 2},
    {player: 1, time: 809, x1: 2, y1: 15, x2: 3, y2: 15, orientation: 3},
    {player: 1, time: 827, x1: 2, y1: 13, x2: 2, y2: 14, orientation: 2},
    {player: 1, time: 845, x1: 4, y1: 13, x2: 5, y2: 13, orientation: 3},
    {player: 1, time: 865, x1: 3, y1: 12, x2: 4, y2: 12, orientation: 3},
    {player: 0, time: 875, x1: 3, y1: 13, x2: 3, y2: 12, orientation: 0},
    {player: 0, time: 893, x1: 3, y1: 11, x2: 3, y2: 10, orientation: 0},
    {player: 0, time: 911, x1: 4, y1: 9, x2: 4, y2: 10, orientation: 2},
    {player: 0, time: 929, x1: 3, y1: 8, x2: 4, y2: 8, orientation: 3},
    {player: 0, time: 948, x1: 5, y1: 8, x2: 5, y2: 9, orientation: 2},
    {player: 1, time: 955, x1: 0, y1: 10, x2: 0, y2: 9, orientation: 0},
    {player: 0, time: 966, x1: 2, y1: 13, x2: 2, y2: 12, orientation: 0},
    {player: 1, time: 999, x1: 3, y1: 2, x2: 4, y2: 2, orientation: 3},
    {player: 0, time: 1027, x1: 3, y1: 11, x2: 3, y2: 10, orientation: 0},
  ],
};

const SOFT_FLEX1_VS_FLEX2 = {
  gameSeed: 2750969295,
  screenSeed: 2919067110,
  colorSelections: [
    [0, 1, 3, 4],
    [0, 1, 3, 4],
  ],
  marginFrames: 5760,
  mercyFrames: 450,
  targetPoints: [70, 70],
  moves: [
    {player: 0, time: 0, x1: 5, y1: 15, x2: 4, y2: 15, orientation: 1},
    {player: 1, time: 0, x1: 3, y1: 15, x2: 2, y2: 15, orientation: 1},
    {player: 0, time: 18, x1: 4, y1: 14, x2: 5, y2: 14, orientation: 3},
    {player: 1, time: 18, x1: 2, y1: 14, x2: 1, y2: 14, orientation: 1},
    {player: 0, time: 36, x1: 5, y1: 13, x2: 4, y2: 13, orientation: 1},
    {player: 1, time: 37, x1: 5, y1: 15, x2: 4, y2: 15, orientation: 1},
    {player: 0, time: 54, x1: 1, y1: 15, x2: 2, y2: 15, orientation: 3},
    {player: 1, time: 55, x1: 3, y1: 14, x2: 3, y2: 13, orientation: 0},
    {player: 0, time: 72, x1: 1, y1: 14, x2: 1, y2: 13, orientation: 0},
    {player: 1, time: 73, x1: 4, y1: 14, x2: 4, y2: 13, orientation: 0},
    {player: 0, time: 90, x1: 0, y1: 15, x2: 0, y2: 14, orientation: 0},
    {player: 1, time: 91, x1: 2, y1: 12, x2: 3, y2: 12, orientation: 3},
    {player: 1, time: 110, x1: 3, y1: 10, x2: 3, y2: 11, orientation: 2},
    {player: 1, time: 128, x1: 1, y1: 14, x2: 1, y2: 13, orientation: 0},
    {player: 0, time: 130, x1: 1, y1: 14, x2: 2, y2: 14, orientation: 3},
    {player: 1, time: 146, x1: 3, y1: 9, x2: 2, y2: 9, orientation: 1},
    {player: 0, time: 149, x1: 0, y1: 14, x2: 1, y2: 14, orientation: 3},
    {player: 0, time: 167, x1: 5, y1: 11, x2: 5, y2: 12, orientation: 2},
    {player: 1, time: 167, x1: 3, y1: 8, x2: 3, y2: 7, orientation: 0},
    {player: 0, time: 185, x1: 5, y1: 10, x2: 4, y2: 10, orientation: 1},
    {player: 1, time: 185, x1: 1, y1: 12, x2: 0, y2: 12, orientation: 1},
    {player: 0, time: 205, x1: 5, y1: 9, x2: 4, y2: 9, orientation: 1},
    {player: 1, time: 206, x1: 4, y1: 12, x2: 4, y2: 11, orientation: 0},
    {player: 0, time: 247, x1: 3, y1: 13, x2: 2, y2: 13, orientation: 1},
    {player: 1, time: 294, x1: 4, y1: 11, x2: 5, y2: 11, orientation: 3},
    {player: 0, time: 307, x1: 2, y1: 13, x2: 3, y2: 13, orientation: 3},
    {player: 0, time: 327, x1: 2, y1: 12, x2: 1, y2: 12, orientation: 1},
    {player: 1, time: 344, x1: 3, y1: 7, x2: 2, y2: 7, orientation: 1},
    {player: 0, time: 348, x1: 0, y1: 13, x2: 1, y2: 13, orientation: 3},
    {player: 0, time: 367, x1: 2, y1: 11, x2: 1, y2: 11, orientation: 1},
    {player: 1, time: 367, x1: 0, y1: 11, x2: 0, y2: 12, orientation: 2},
    {player: 1, time: 385, x1: 0, y1: 9, x2: 0, y2: 10, orientation: 2},
    {player: 1, time: 403, x1: 1, y1: 9, x2: 1, y2: 10, orientation: 2},
    {player: 1, time: 421, x1: 2, y1: 8, x2: 1, y2: 8, orientation: 1},
    {player: 1, time: 442, x1: 5, y1: 12, x2: 5, y2: 11, orientation: 0},
    {player: 0, time: 467, x1: 3, y1: 15, x2: 3, y2: 14, orientation: 0},
    {player: 0, time: 524, x1: 2, y1: 15, x2: 2, y2: 14, orientation: 0},
    {player: 0, time: 542, x1: 2, y1: 13, x2: 1, y2: 13, orientation: 1},
    {player: 0, time: 562, x1: 3, y1: 13, x2: 3, y2: 14, orientation: 2},
    {player: 0, time: 580, x1: 3, y1: 12, x2: 3, y2: 11, orientation: 0},
    {player: 0, time: 598, x1: 3, y1: 10, x2: 2, y2: 10, orientation: 1},
    {player: 0, time: 618, x1: 1, y1: 14, x2: 1, y2: 13, orientation: 0},
    {player: 0, time: 636, x1: 3, y1: 9, x2: 4, y2: 9, orientation: 3},
    {player: 1, time: 699, x1: 1, y1: 12, x2: 2, y2: 12, orientation: 3},
    {player: 1, time: 760, x1: 4, y1: 15, x2: 4, y2: 14, orientation: 0},
    {player: 1, time: 778, x1: 3, y1: 13, x2: 3, y2: 14, orientation: 2},
    {player: 1, time: 796, x1: 2, y1: 12, x2: 3, y2: 12, orientation: 3},
    {player: 0, time: 808, x1: 5, y1: 8, x2: 5, y2: 9, orientation: 2},
    {player: 1, time: 817, x1: 3, y1: 11, x2: 2, y2: 11, orientation: 1},
    {player: 1, time: 838, x1: 4, y1: 13, x2: 4, y2: 12, orientation: 0},
    {player: 0, time: 852, x1: 3, y1: 3, x2: 2, y2: 3, orientation: 1},
    {player: 1, time: 856, x1: 5, y1: 11, x2: 4, y2: 11, orientation: 1},
    {player: 1, time: 877, x1: 4, y1: 10, x2: 4, y2: 9, orientation: 0},
  ],
  metadata: {
    names: ['Soft FlexDroplet1 (bot)', 'FlexDroplet2 (bot)'],
    elos: [1807, 1000],
    priorWins: [0, 0],
    event: 'Free Play (pausing / alpha)',
    site: 'https://pujo.lumipakkanen.com',
    round: 0,
    timeControl: '60+10(max:120)',
    msSince1970: 1698824178514,
    type: 'pausing',
    server: {
      version: '0.0.1',
      resolved: '2cae1a1',
      name: 'pujo-ws-server',
      core: {
        version: '0.1.0',
        resolved:
          'git+ssh://git@github.com/frostburn/pujo-puyo-core.git#c0c8f1e8ada51f6d7c9aaad72dcf40eb8797fd6d',
      },
    },
    clients: [
      {
        name: 'pujo-ws-server',
        version: '0.0.1',
        resolved: '2cae1a1',
        core: {
          version: '0.1.0',
          resolved:
            'git+ssh://git@github.com/frostburn/pujo-puyo-core.git#c0c8f1e8ada51f6d7c9aaad72dcf40eb8797fd6d',
        },
      },
      {
        name: 'pujo-ws-server',
        version: '0.0.1',
        resolved: '2cae1a1',
        core: {
          version: '0.1.0',
          resolved:
            'git+ssh://git@github.com/frostburn/pujo-puyo-core.git#c0c8f1e8ada51f6d7c9aaad72dcf40eb8797fd6d',
        },
      },
    ],
    endTime: 1698824180726,
  },
  result: {winner: 1, reason: 'lockout'},
};

(async () => {
  // XXX: Assumes that there are existing users.
  await saveReplay(LUMI_VS_FLEX2, [1, 2]);

  await saveReplay(SOFT_FLEX1_VS_FLEX2, [1, 2]);
  await sql.end();
})();
